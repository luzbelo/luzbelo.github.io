<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cotizacion AirBNB</title>
  <style>
  body {font-family: Arial, sans-serif;
        margin: 5px;
        background: #f5f5f5;}
  .form-container {background: white;
                   padding: 5px;
                  border-radius: 8px;
                  max-width: 350px;
                  width: 100%;              /* ðŸ‘ˆ importante */
                  box-sizing: border-box;   /* ðŸ‘ˆ evita desbordes */
                  margin: auto;
                  box-shadow: 0 2px 6px rgba(0,0,0,0.2);}
  .form-row {display: flex;
             align-items: center;
             margin-bottom: 5px;}
  .form-row label {width: 170px;}
  .form-row input,
  .form-row select,
  .form-row textarea {flex: 1;
                      padding: 3px;
                      border: 1px solid #ccc;
                      border-radius: 4px;}
  input[readonly], textarea[readonly] {background-color: #e9ecef;
                                       border: 1px dashed #999;
                                       font-weight: bold;
                                       cursor: not-allowed;}
  textarea {resize: vertical;}
  button {margin-top: 15px;
          padding: 10px 15px;
          border: none;
          background: #007bff;
          color: white;
          border-radius: 4px;
          cursor: pointer;
          width: 100%;}
  button:hover {background: #0056b3;}
  .full-width {display: flex;
               flex-direction: column;
               width: 100%;
               grid-column: 1 / -1; /* si usas grid en el container */}
  .full-width textarea {width: 100%;
                        min-height: 180px;
                        resize: vertical;
                        box-sizing: border-box;}
@media (max-width: 600px) {
  body {
    margin: 10px;
  }
  .form-row {
    flex-direction: column;   /* label arriba, input abajo */
    align-items: stretch;
  }
  .form-row label {
    width: 100%;
    margin-bottom: 4px;
  }
  input,
  select,
  textarea,
  button {
    width: 100%;
    font-size: 16px;          /* evita zoom en iPhone */
    box-sizing: border-box;
  }
  textarea {
    min-height: 160px;
  }
  button {
    padding: 12px;
  }
}    
  </style>
</head>
<body>
<div class="form-container">
  <form id="formReserva">
    <div class="form-row">
      <label>UbicaciÃ³n</label>
      <select id="ubicacion" onchange="actualizarDatos()">
      <option value="Prado" selected>Prado</option>
      <option value="Beijin">Beijin</option>
      <option value="Equipe">Equipe</option>
      <option value="Millenial">Millenial</option>
      </select>
    </div>
    <div class="form-row"><label>USD/noche sugerido </label><input type="number" id="precioSugerido" readonly>                                  </div>
    <div class="form-row"><label>HuÃ©spedes incluidos</label><input type="number" id="huespedesIncluidos" readonly>                              </div>
    <div class="form-row"><label>USD HuÃ©sped add    </label><input type="number" id="huespedAdicional" readonly>                                </div>
    <div class="form-row"><label>Check IN           </label><input type="date"   id="checkin" onchange="calcularTotal()">                       </div>
    <div class="form-row"><label>Check OUT          </label><input type="date"   id="checkout" onchange="calcularTotal()">                      </div>
    <div class="form-row"><label>HuÃ©spedes solicitud</label><input type="number" id="huespedes" min="1" onchange="calcularTotal()">             </div>
    <div class="form-row"><label>USD/noche          </label><input type="number" id="precio" step="0.01" onchange="calcularTotal()">            </div>
    <div class="form-row"><label>Descuento USD  (%) </label><input type="number" id="desc_usd" value="15" onchange="calcularTotal()">           </div>
    <div class="form-row"><label>Descuento USDT (%) </label><input type="number" id="desc_usdt" value="12" onchange="calcularTotal()">          </div>
    <div class="form-row"><label>Descuento BOB  (%) </label><input type="number" id="desc_bob" value="10" onchange="calcularTotal()">           </div>
    <div class="form-row"><label>Exchange Rate      </label><input type="number" id="exchange" value="9" step="0.1" onchange="calcularTotal()"> </div>
    <div class="form-row"><label>Limpiezas regalo   </label><input type="number" id="limpiezas" value="0" step="1" onchange="calcularTotal()">  </div>
    <div class="form-row"><label>USD Total          </label><input type="number" id="total" readonly>                                           </div>
    <div class="full-width">
      <label for="msgWhatsapp">MSG WhatsApp</label>
      <textarea id="msgWhatsapp" rows="12" readonly></textarea>
    </div>
    <button type="submit">Copiar Mensaje</button>
  </form>
</div>
<script>
const datosUbicacion = {
  "Prado":     { precio: 49, huespedes: 4, adicional: 11 },
  "Equipe":    { precio: 33, huespedes: 2, adicional: 8 },
  "Millenial": { precio: 34, huespedes: 2, adicional: 8 },
  "Beijin":    { precio: 21, huespedes: 3, adicional: 8 }
};
// ===== FECHAS SIN ERROR DE ZONA =====
function hoyISO(fecha) {
  const aÃ±o = fecha.getFullYear();
  const mes = String(fecha.getMonth() + 1).padStart(2, "0");
  const dia = String(fecha.getDate()).padStart(2, "0");
  return `${aÃ±o}-${mes}-${dia}`;
}
function crearFechaLocal(fechaStr) {
  const p = fechaStr.split("-");
  return new Date(p[0], p[1] - 1, p[2]);
}
function diasEntre(f1, f2) {
  if (!f1 || !f2) return 0;
  const d1 = crearFechaLocal(f1);
  const d2 = crearFechaLocal(f2);
  const diff = (d2 - d1) / (1000 * 60 * 60 * 24);
  return diff > 0 ? diff : 0;
}
function formatearFecha(fechaStr) {
  if (!fechaStr) return "";
  const meses = ["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"];
  const fecha = crearFechaLocal(fechaStr);
  return fecha.getDate() + "/" + meses[fecha.getMonth()];
}
// ===== LOGICA PRINCIPAL =====
function actualizarDatos() {
  const ubicacion = document.getElementById("ubicacion").value;
  const datos = datosUbicacion[ubicacion];
  document.getElementById("precioSugerido").value = datos.precio;
  document.getElementById("huespedesIncluidos").value = datos.huespedes;
  document.getElementById("huespedAdicional").value = datos.adicional;
  document.getElementById("huespedes").value = datos.huespedes;
  document.getElementById("precio").value = datos.precio;
  calcularTotal();
}

function calcularTotal() {
  const ubicacion = document.getElementById("ubicacion").value;
  const checkin = document.getElementById("checkin").value;
  const checkout = document.getElementById("checkout").value;
  const huespedes = Number(document.getElementById("huespedes").value);
  const precio = Number(document.getElementById("precio").value);
  const incluidos = Number(document.getElementById("huespedesIncluidos").value);
  const adicional = Number(document.getElementById("huespedAdicional").value);
  const descUSD = Number(document.getElementById("desc_usd").value);
  const descUSDT = Number(document.getElementById("desc_usdt").value);
  const descBOB = Number(document.getElementById("desc_bob").value);
  const exchange = Number(document.getElementById("exchange").value);
  const limpiezas = Number(document.getElementById("limpiezas").value);
  const noches = diasEntre(checkin, checkout);
  let precioNocheFinal = precio;
  if (huespedes > incluidos) {
    precioNocheFinal = precio + (huespedes - incluidos) * adicional;
  }
  const total = noches * precioNocheFinal;
  document.getElementById("total").value = total.toFixed(2);
  const usdFinal = total * (1 - descUSD / 100);
  const usdtFinal = total * (1 - descUSDT / 100);
  const bobFinal = total * (1 - descBOB / 100) * exchange;
  let plus = "";
  if (limpiezas > 0) {
    plus = `
âœ¨*Plus adicional*âœ¨
- Servicios de limpieza: ${limpiezas}
- Cambio de sabanas: ${limpiezas}
- Cambio de toallas: ${limpiezas}`;
  }
  const mensaje =
`âœ¨*Detalle de reserva: ${ubicacion.toUpperCase()}*âœ¨
- Huespedes: ${huespedes}
- Del ${formatearFecha(checkin)} al ${formatearFecha(checkout)}: *${noches} noches*
- Precio x noche: *${precioNocheFinal} $us*
- ${noches} x ${precioNocheFinal} = *${total.toFixed(0)} $us (Sin descuento)*ðŸ‘ˆðŸ½

âœ¨*Formas de pago*âœ¨
- ðŸ‡ºðŸ‡¸*_${usdFinal.toFixed(0)} $us_* (Efectivo, Zelle) *${descUSD}% Menos*
- ðŸ‡ºðŸ‡¸*_${usdtFinal.toFixed(0)} USDT_* (Binance) *${descUSDT}% Menos*
- ðŸ‡§ðŸ‡´*_${bobFinal.toFixed(0)} Bs_* (QR) *${descBOB}% Menos*
- Tasa cambio *${exchange}* (Paralelo esta ${exchange + 0.5})`
+ plus;
  document.getElementById("msgWhatsapp").value = mensaje;
}

function inicializarFechas() {
  const hoy = new Date();
  const salida = new Date();
  salida.setDate(hoy.getDate() + 2);
  document.getElementById("checkin").value = hoyISO(hoy);
  document.getElementById("checkout").value = hoyISO(salida);
}

window.onload = function() {
  inicializarFechas();
  actualizarDatos();
  calcularTotal();
};
// ===== COPIAR AL CLIPBOARD =====
document.getElementById("formReserva").addEventListener("submit", function(e) {
  e.preventDefault();
  const texto = document.getElementById("msgWhatsapp").value;
  navigator.clipboard.writeText(texto)
    .then(() => alert("Mensaje copiado al portapapeles âœ…"))
    .catch(() => alert("Error al copiar"));
});
// ===== BLOQUEAR ENTER =====
document.getElementById("formReserva").addEventListener("keydown", function(e) {
  if (e.key === "Enter") {
    e.preventDefault();
  }
});
</script>

</body>
</html>